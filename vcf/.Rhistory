ForPloting153<-as.data.frame(shift(variantM153T, c(0,-1,-2)))
View(ForPloting153)
variantA211V<-data.frame("nsp15:N73N" = 181,
"nsp15:N73N+N:A211V" = 356,
"nsp15:N73N+N:A211V+nsp2:D23N+nsp2:D409G+nsp3:S1578I+nsp3:K1715R+S:Q675R" = 58,
"nsp15:N73N+N:A211V+nsp2:D23N+nsp2:D409G+nsp3:S1578I+nsp3:K1715R+S:Q675R+S:D138Y+S:S477N+S:A845S" = 147)
colnames(variantA211V)<-c("Count")
variantM153T<-(data.frame("S:M153T" = 295,
"S:M153T+N:M234I" = 57,
"S:M153T+N:M234I+S:N679K" = 67,
"S:M153T+N:M234I+ORF8:V62L+S:D138Y" = 175))
colnames(variantM153T)<-c("Count")
View(variantM153T)
variantA211V<-data.frame("nsp15:N73N" = 181,
"nsp15:N73N+N:A211V" = 356,
"nsp15:N73N+N:A211V+nsp2:D23N+nsp2:D409G+nsp3:S1578I+nsp3:K1715R+S:Q675R" = 58,
"nsp15:N73N+N:A211V+nsp2:D23N+nsp2:D409G+nsp3:S1578I+nsp3:K1715R+S:Q675R+S:D138Y+S:S477N+S:A845S" = 147)
rownames(variantA211V)<-c("Count")
variantM153T<-(data.frame("S:M153T" = 295,
"S:M153T+N:M234I" = 57,
"S:M153T+N:M234I+S:N679K" = 67,
"S:M153T+N:M234I+ORF8:V62L+S:D138Y" = 175))
rownames(variantM153T)<-c("Count")
ForPloting<-as.data.frame(shift(variantA211V, c(0,-1,-2,-3)))
ForPloting[is.na(ForPloting)]<-0
View(ForPloting)
variantA211V<-data.frame(t(data.frame("nsp15:N73N" = 181,
"nsp15:N73N+N:A211V" = 356,
"nsp15:N73N+N:A211V+nsp2:D23N+nsp2:D409G+nsp3:S1578I+nsp3:K1715R+S:Q675R" = 58,
"nsp15:N73N+N:A211V+nsp2:D23N+nsp2:D409G+nsp3:S1578I+nsp3:K1715R+S:Q675R+S:D138Y+S:S477N+S:A845S" = 147)))
colnames(variantA211V)<-c("Count")
variantM153T<-data.frame(t(data.frame("S:M153T" = 295,
"S:M153T+N:M234I" = 57,
"S:M153T+N:M234I+S:N679K" = 67,
"S:M153T+N:M234I+ORF8:V62L+S:D138Y" = 175)))
colnames(variantM153T)<-c("Count")
ForPloting<-as.data.frame(shift(variantA211V, c(0,-1,-2,-3)))
ForPloting[is.na(ForPloting)]<-0
ForPloting$Sum<-rowSums(ForPloting)
as.vector(shirt(variantM153T)
)
as.vector(shift(variantM153T))
as.vector(shift(variantM153T,-1))
variantM153T[3,1]
ForPloting153$Counts<-c(sum(as.vector(shift(variantM153T,0))),
sum(as.vector(shift(variantM153T,-1))),
variantM153T[3,1],
variantM153T[4,1])
sum(as.vector(shift(variantM153T,0)))
sum(vector(shift(variantM153T,0)))
sum(shift(variantM153T,0)[[1]])
ForPloting153$Counts<-c(sum(shift(variantM153T,0)[[1]]),
sum(vector(shift(variantM153T,-1))[[1]]),
variantM153T[3,1],
variantM153T[4,1])
sum(variantM153T[,1])
ForPloting153$Counts<-c(sum(variantM153T[,1]),
sum(variantM153T[2:4,1]),
variantM153T[3,1],
variantM153T[4,1])
View(ForPloting153)
ForPloting153$Names<-c("S:M153T","N:M234I","S:N679K","S:D138Y")
ForPloting153$Counts<-c(sum(variantM153T[,1]),
sum(variantM153T[2:4,1]),
variantM153T[3,1],
variantM153T[4,1])
View(ForPloting153)
ForPloting153<-data.frame(Names=c("S:M153T","N:M234I","S:N679K","S:D138Y"))
ForPloting153$Counts<-c(sum(variantM153T[,1]),
sum(variantM153T[2:4,1]),
variantM153T[3,1],
variantM153T[4,1])
ForPloting153<-data.frame(Names=c("S:M153T","N:M234I","S:N679K","S:D138Y"))
ForPloting153$Counts<-c(sum(variantM153T[,1]),
sum(variantM153T[2:4,1]),
variantM153T[3,1],
variantM153T[4,1])
ForPloting153$x0 <-rep(0,4)
ForPloting153$y0<-c(0,0,(-ForPloting153[2,2]+ForPloting153[3,2]+10),
(ForPloting153[2,2]-ForPloting153[4,2] -10 ))
ForPloting153<-data.frame(Names=c("S:M153T","N:M234I","S:N679K","S:D138Y"))
ForPloting153$Names<-factor(ForPloting153$Names, levels = ForPloting153$Names)
ForPloting153$Counts<-c(sum(variantM153T[,1]),
sum(variantM153T[2:4,1]),
variantM153T[3,1],
variantM153T[4,1])
ForPloting153$x0 <-rep(0,4)
ForPloting153$y0<-c(0,0,(-ForPloting153[2,2]+ForPloting153[3,2]+10),
(ForPloting153[2,2]-ForPloting153[4,2] -10 ))
colors153<-c("#A47102","#C08C04","#DBA606","#F7C108")
names(colors153)<-ForPloting153$Names
ggplot(data = ForPloting153)+
geom_circle(aes(x0 = x0, y0 = y0, r = Sum, fill = Names))+
scale_fill_manual(values = colors153)+
geom_text(aes(label = Names,
x = 0, y =Sum-40))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
ggplot(data = ForPloting153)+
geom_circle(aes(x0 = x0, y0 = y0, r = Counts, fill = Names))+
scale_fill_manual(values = colors153)+
geom_text(aes(label = Names,
x = 0, y =Counts-40))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
ForPloting153<-data.frame(Names=c("S:M153T","N:M234I","S:N679K","S:D138Y"))
ForPloting153$Names<-factor(ForPloting153$Names, levels = ForPloting153$Names)
ForPloting153$Counts<-c(sum(variantM153T[,1]),
sum(variantM153T[2:4,1]),
variantM153T[3,1],
variantM153T[4,1])
ForPloting153$y0 <-rep(0,4)
ForPloting153$x0<-c(0,0,(-ForPloting153[2,2]+ForPloting153[3,2]+10),
(ForPloting153[2,2]-ForPloting153[4,2] -10 ))
colors153<-c("#A47102","#C08C04","#DBA606","#F7C108")
names(colors153)<-ForPloting153$Names
ggplot(data = ForPloting153)+
geom_circle(aes(x0 = x0, y0 = y0, r = Counts, fill = Names))+
scale_fill_manual(values = colors153)+
geom_text(aes(label = Names,
x = 0, y =Counts-40))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
ggplot(data = ForPloting153)+
geom_circle(aes(x0 = x0, y0 = y0, r = Counts, fill = Names))+
scale_fill_manual(values = colors153)+
geom_text(aes(label = Names,
x = x0, y =Counts-40))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
ggplot(data = ForPloting153)+
geom_circle(aes(x0 = x0, y0 = y0, r = Counts, fill = Names))+
scale_fill_manual(values = colors153)+
geom_text(aes(label = Names,
x = x0, y =Counts-60))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
library(ggplot2)
library(ggforce)
library(data.table)
library(ggpubr)
install.packages("ggpubr")
install.packages("ggpubr")
library(ggplot2)
library(ggforce)
library(data.table)
library(ggpubr)
library(ggplot2)
library(ggforce)
library(data.table)
library(ggpubr)
install.packages("ggpubr")
install.packages("ggpubr")
R.version()
library(ggplot2)
library(ggforce)
library(data.table)
library(ggpubr)
install.packages("stringi")
install.packages("ggpubr")
library(ggplot2)
library(ggforce)
library(data.table)
library(ggpubr)
variantA211V<-data.frame(t(data.frame("N:A211V" = 442,
"N:A211V+S:Q675R+S:D138Y+S:S477N+S:A845S" = 158)))
colnames(variantA211V)<-c("Count")
variantA211V<-data.frame(t(data.frame("N:A211V" = 442,
"N:A211V+S:Q675R+S:D138Y+S:S477N+S:A845S" = 158)))
colnames(variantA211V)<-c("Count")
variantA211V<-data.frame(t(data.frame("N:A211V" = 442,
"N:A211V+S:Q675R+S:D138Y+S:S477N+S:A845S" = 158)))
colnames(variantA211V)<-c("Count")
variantM153T<-data.frame(t(data.frame("S:M153T" = 295,
"S:M153T+N:M234I" = 57,
"S:M153T+N:M234I+S:D138Y" = 175,
"S:M153T+N:M234I+S:N679K" = 67)))
colnames(variantM153T)<-c("Count")
#A211V
ForPloting$Names<-c("N:A211V",
"S:Q675R+S:D138Y+S:S477N+S:A845S")
ForPloting$Sum<-c(sum(variantA211V$Count), variantA211V[2,1])
ForPloting$Names<-factor(ForPloting$Names, levels = ForPloting$Names)
ForPloting$x0<-rep(0,2)
ForPloting$y0<-rep(0,2)
colorsA211V<-c("#14A2A8","#07676B")
names(colorsA211V)<-ForPloting$Names
Aplot<-ggplot(data = ForPloting)+
geom_circle(aes(x0 = x0, y0 = y0, r = Count, fill = Names))+
scale_fill_manual(values = colorsA211V)+
geom_text(aes(label = Names,
x = 0, y =Sum-40))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
Aplot
ForPloting<-data.frame(Names = c("N:A211V",
"S:Q675R+S:D138Y+S:S477N+S:A845S"))
ForPloting$Sum<-c(sum(variantA211V$Count), variantA211V[2,1])
ForPloting$Names<-factor(ForPloting$Names, levels = ForPloting$Names)
ForPloting$x0<-rep(0,2)
ForPloting$y0<-rep(0,2)
colorsA211V<-c("#14A2A8","#07676B")
names(colorsA211V)<-ForPloting$Names
Aplot<-ggplot(data = ForPloting)+
geom_circle(aes(x0 = x0, y0 = y0, r = Count, fill = Names))+
scale_fill_manual(values = colorsA211V)+
geom_text(aes(label = Names,
x = 0, y =Sum-40))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
Aplot
Aplot<-ggplot(data = ForPloting)+
geom_circle(aes(x0 = x0, y0 = y0, r = Sum, fill = Names))+
scale_fill_manual(values = colorsA211V)+
geom_text(aes(label = Names,
x = 0, y =Sum-40))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
Aplot
########
Aplot<-ggplot(data = ForPloting)+
geom_circle(aes(x0 = x0, y0 = y0, r = Sum, fill = Names))+
scale_fill_manual(values = colorsA211V)+
geom_text(aes(label = Names,
x = 0, y =Sum-80))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
Aplot
ForPloting153<-data.frame(Names=c("S:M153T","N:M234I","S:D138Y","S:N679K"))
ForPloting153$Names<-factor(ForPloting153$Names, levels = ForPloting153$Names)
ForPloting153$Counts<-c(sum(variantM153T[,1]),
sum(variantM153T[2:4,1]),
variantM153T[3,1],
variantM153T[4,1])
ForPloting153$y0 <-rep(0,4)
ForPloting153$x0<-c(0,0,(-ForPloting153[2,2]+ForPloting153[3,2]+10),
(ForPloting153[2,2]-ForPloting153[4,2] -10 ))
colors153<-c("#F7C108","#DBA606","#C08C04","#A47102")
names(colors153)<-ForPloting153$Names
Bplot<-ggplot(data = ForPloting153)+
geom_circle(aes(x0 = x0, y0 = y0, r = Counts, fill = Names))+
scale_fill_manual(values = colors153)+
geom_text(aes(label = Names,
x = x0, y =Counts-60))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
Bplot
colors153<-c("#F7C108","#DBA606","#A47102","#C08C04")
names(colors153)<-ForPloting153$Names
Bplot<-ggplot(data = ForPloting153)+
geom_circle(aes(x0 = x0, y0 = y0, r = Counts, fill = Names))+
scale_fill_manual(values = colors153)+
geom_text(aes(label = Names,
x = x0, y =Counts-60))+
theme_classic()+
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank())
Bplot
plot<ggarrange(Aplot,
Bplot,
ncol = 2,
labels = c("a","b"))
plot
plot<-ggarrange(Aplot,
Bplot,
ncol = 2,
labels = c("a","b"))
plot
ggsave("./plot.svg", plot = plot,
width = 18,
height = 8,
units = "cm",
dpi =300)
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 18,
height = 8,
units = "cm",
dpi =300)
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 36,
height = 12,
units = "cm",
dpi =300)
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 36,
height = 12,
units = "cm",
dpi =800)
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 18,
height = 7,
units = "cm",
dpi =800)
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 180,
height = 70,
units = "mm",
dpi =800)
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 180,
height = 70,
units = "mm")
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 250,
height = 100,
units = "mm")
ggsave("/home/garushyants/Documents/nCov2019/rus_variants/20210426_Variants_Diagram/plot.svg", plot = plot,
width = 350,
height = 140,
units = "mm")
fisher.test(c(29,8),c(29703,3822))
fisher.test(c(29,29703),c(8,3822))
binom.test(c(8,21), p=0.13, alternative ="two.sided")
binom.test(c(8,21), p=0.13, alternative ="one.sided")
binom.test(c(8,21), p=0.13, alternative ="greter")
binom.test(c(8,21), p=0.13, alternative ="greater")
binom.test(c(8,24), p=0.13, alternative ="greater")
binom.test(c(8,24), p=0.128, alternative ="greater")
binom.test(c(8,21), p=0.128, alternative ="greater")
binom.test(c(32,68), p=0.128, alternative ="greater")
binom.test(c(32,68), p=0.13, alternative ="two.sided")
binom.test(c(2,30), p=0.02, alternative ="two.sided")
binom.test(c(8,17), p=0.13, alternative ="two.sided")
binom.test(c(2,23), p=0.02, alternative ="two.sided")
binom.test(c(8,17), p=0.13, alternative ="greater")
binom.test(c(2,23), p=0.02, alternative ="greater")
binom.test(c(8,26), p=0.13, alternative ="greater")
binom.test(c(8,26), p=0.13, alternative ="two.sided")
library(MutationalPatterns)
library(BSgenome.Ecoli.NCBI.ASM218019v1)
library(ggplot2)
library(ggpubr)
library(MutationalPatterns)
install.packages("pkgmaker")
install.packages("RcppSimdJson")
version
library(sf)
install.packages("sf")
install.packages("terra")
library(here)
library(tidyverse)
library(sf)
library(mapview)
mapviewOptions(fgb = FALSE)
library(BSgenome)
library(BSgenome.Ecoli.NCBI.11strains)
library(MutationalPatterns)
library(Biostrings)
library(ggplot2)
library(reshape2)
library(dplyr)
library(tidyr)
library(ggpubr)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("BSgenome")
library(BSgenome)
library(BSgenome)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("BSgenome")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("BSgenome")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("BSgenome")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("BSgenome")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("MutationalPatterns")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("MutationalPatterns")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("MutationalPatterns")
########load genome
library(BSgenome)
library(BSgenome.Ecoli.NCBI.11strains)
library(MutationalPatterns)
library(Biostrings)
library(ggplot2)
library(reshape2)
library(dplyr)
library(tidyr)
library(ggpubr)
#We load signatures
setwd("/home/garushyants/Yandex.Disk/BactMutSIgns/20201208")
#Read signatures from csv files
sig6_NMF<-read.csv("Ecoli_signatures6_NMF_no_norm_20201208.csv",
sep =" ")
sig6_data<-read.csv("Ecoli_signatures6_from_data_20201208.csv",
sep =" ")
ref_genome<-"BSgenome.Ecoli.NCBI.11strains"
#Let's read the nonmutator data
###load vcfs
setwd("/home/garushyants/Yandex.Disk/BactMutSIgns/20201201/vcf")
nm_sample_names<-c("non-mutator","wt_F","ED1a","IAI1")#, "nm_i","wt_F_i", "ED1a_i","IAI1_i")
nm_vcf_files<-c("LTEE/nonmutator_allSNPs.vcf",
"Foster2015/Foster2015_nonmut.vcf",
"Foster2015/Foster2015_nonmut_ED1a.vcf",
"Foster2015/Foster2015_nonmut_IAI1.vcf")
#
nm_vcfs <- read_vcfs_as_granges(nm_vcf_files, nm_sample_names, genome = ref_genome)
##non mutators intergenic
nmi_sample_names<-c("nm_i","wt_F_i", "ED1a_i","IAI1_i")
nmi_vcf_files<-c("LTEE/nonmutator_intergenic.vcf",
"Foster2015/Foster2015_nonmut_intergenic.vcf",
"Foster2015/Foster2015_nonmut_ED1a_intergenic.vcf",
"Foster2015/Foster2015_nonmut_IAI1_intergenic.vcf")
nmi_vcfs <- read_vcfs_as_granges(nmi_vcf_files, nmi_sample_names, genome = ref_genome)
########load genome
library(BSgenome)
library(BSgenome.Ecoli.NCBI.11strains)
library(MutationalPatterns)
library(Biostrings)
library(ggplot2)
library(reshape2)
library(dplyr)
library(tidyr)
library(ggpubr)
#We load signatures
setwd("/home/garushyants/Yandex.Disk/BactMutSIgns/20201208")
#Read signatures from csv files
sig6_NMF<-read.csv("Ecoli_signatures6_NMF_no_norm_20201208.csv",
sep =" ")
sig6_data<-read.csv("Ecoli_signatures6_from_data_20201208.csv",
sep =" ")
ref_genome<-"BSgenome.Ecoli.NCBI.11strains"
##########
#Let's read the nonmutator data
###load vcfs
setwd("/home/garushyants/Yandex.Disk/BactMutSIgns/20201201/vcf")
nm_sample_names<-c("non-mutator","wt_F","ED1a","IAI1")#, "nm_i","wt_F_i", "ED1a_i","IAI1_i")
nm_vcf_files<-c("LTEE/nonmutator_allSNPs.vcf",
"Foster2015/Foster2015_nonmut.vcf",
"Foster2015/Foster2015_nonmut_ED1a.vcf",
"Foster2015/Foster2015_nonmut_IAI1.vcf")
#
nm_vcfs <- read_vcfs_as_granges(nm_vcf_files, nm_sample_names, genome = ref_genome)
##non mutators intergenic
nmi_sample_names<-c("nm_i","wt_F_i", "ED1a_i","IAI1_i")
nmi_vcf_files<-c("LTEE/nonmutator_intergenic.vcf",
"Foster2015/Foster2015_nonmut_intergenic.vcf",
"Foster2015/Foster2015_nonmut_ED1a_intergenic.vcf",
"Foster2015/Foster2015_nonmut_IAI1_intergenic.vcf")
nmi_vcfs <- read_vcfs_as_granges(nmi_vcf_files, nmi_sample_names, genome = ref_genome)
setwd("/home/garushyants/Yandex.Disk/BactMutSIgns/20201201/vcf")
nm_sample_names<-c("non-mutator","wt_F")#,"ED1a","IAI1")#, "nm_i","wt_F_i", "ED1a_i","IAI1_i")
nm_vcf_files<-c("LTEE/nonmutator_allSNPs.vcf",
"Foster2015/Foster2015_nonmut.vcf")#,
#"Foster2015/Foster2015_nonmut_ED1a.vcf",
#"Foster2015/Foster2015_nonmut_IAI1.vcf")
#
nm_vcfs <- read_vcfs_as_granges(nm_vcf_files, nm_sample_names, genome = ref_genome)
setwd("/home/garushyants/Yandex.Disk/BactMutSIgns/20201201/vcf")
nm_sample_names<-c("non-mutator","wt_F")#,"ED1a","IAI1")#, "nm_i","wt_F_i", "ED1a_i","IAI1_i")
nm_vcf_files<-c(#"LTEE/nonmutator_allSNPs.vcf",
"Foster2015/Foster2015_nonmut.vcf",
"Foster2015/Foster2015_nonmut_ED1a.vcf")#,
#"Foster2015/Foster2015_nonmut_IAI1.vcf")
#
nm_vcfs <- read_vcfs_as_granges(nm_vcf_files, nm_sample_names, genome = ref_genome)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
